<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Foray Library: foray::util::DualBuffer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Foray Library
   </div>
   <div id="projectbrief">rapid prototyping framework for crossplatform development of vulkan hardware ray tracing applications</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceforay.html">foray</a></li><li class="navelem"><a class="el" href="namespaceforay_1_1util.html">util</a></li><li class="navelem"><a class="el" href="classforay_1_1util_1_1DualBuffer.html">DualBuffer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classforay_1_1util_1_1DualBuffer-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">foray::util::DualBuffer Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Helper class for organizing CPU -&gt; GPU data synchronisation. In flight data is stored on host side, and copied to GPU right before being used.  
 <a href="classforay_1_1util_1_1DualBuffer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="foray__dualbuffer_8hpp_source.html">foray_dualbuffer.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for foray::util::DualBuffer:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classforay_1_1util_1_1DualBuffer.png" usemap="#foray::util::DualBuffer_map" alt=""/>
  <map id="foray::util::DualBuffer_map" name="foray::util::DualBuffer_map">
<area href="classforay_1_1NoMoveDefaults.html" title="Simple types for supressing automatic definition of duplicating move constructors &amp; operator." alt="foray::NoMoveDefaults" shape="rect" coords="0,0,142,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae046fc821df5c34879274a6b3affbfe9" id="r_ae046fc821df5c34879274a6b3affbfe9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#ae046fc821df5c34879274a6b3affbfe9">Create</a> (<a class="el" href="structforay_1_1core_1_1Context.html">core::Context</a> *context, const <a class="el" href="structforay_1_1core_1_1ManagedBuffer_1_1CreateInfo.html">core::ManagedBuffer::CreateInfo</a> &amp;devicebufferCreateInfo, uint32_t stageBufferCount=<a class="el" href="namespaceforay.html#a15b6b3f8d9dc6448821cf9a73ef346a6">INFLIGHT_FRAME_COUNT</a>)</td></tr>
<tr class="memdesc:ae046fc821df5c34879274a6b3affbfe9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates the dualbuffer setup.  <br /></td></tr>
<tr class="separator:ae046fc821df5c34879274a6b3affbfe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0efab9223216bc4e7c865157287f8e23" id="r_a0efab9223216bc4e7c865157287f8e23"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#a0efab9223216bc4e7c865157287f8e23">StageFullBuffer</a> (uint32_t frameIndex, const void *data)</td></tr>
<tr class="memdesc:a0efab9223216bc4e7c865157287f8e23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the entire staging buffer.  <br /></td></tr>
<tr class="separator:a0efab9223216bc4e7c865157287f8e23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b25a6592c7a39b1a500428575919bdd" id="r_a7b25a6592c7a39b1a500428575919bdd"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#a7b25a6592c7a39b1a500428575919bdd">StageSection</a> (uint32_t frameIndex, const void *data, size_t destOffset, size_t size)</td></tr>
<tr class="memdesc:a7b25a6592c7a39b1a500428575919bdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates a section of a staging buffer.  <br /></td></tr>
<tr class="separator:a7b25a6592c7a39b1a500428575919bdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeea3a09a161b08038e4788fe4ba05d05" id="r_aeea3a09a161b08038e4788fe4ba05d05"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#aeea3a09a161b08038e4788fe4ba05d05">CmdCopyToDevice</a> (uint32_t frameIndex, VkCommandBuffer cmdBuffer)</td></tr>
<tr class="memdesc:aeea3a09a161b08038e4788fe4ba05d05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes commands required to copy the changes recorded in the indexed staging buffer to the device buffer.  <br /></td></tr>
<tr class="separator:aeea3a09a161b08038e4788fe4ba05d05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16509bc97b78457b76f6b7581b3b7bf2" id="r_a16509bc97b78457b76f6b7581b3b7bf2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#a16509bc97b78457b76f6b7581b3b7bf2">CmdPrepareForRead</a> (VkCommandBuffer cmdBuffer, VkPipelineStageFlags2 dstStageMask, VkAccessFlags2 dstAccessMask) const</td></tr>
<tr class="memdesc:a16509bc97b78457b76f6b7581b3b7bf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepares the device buffer for read access with a pipeline barrier (must be called before read access happens to the buffer)  <br /></td></tr>
<tr class="separator:a16509bc97b78457b76f6b7581b3b7bf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba3677f684e9f7bce7ab67e2c18790d0" id="r_aba3677f684e9f7bce7ab67e2c18790d0"><td class="memItemLeft" align="right" valign="top">virtual VkBufferMemoryBarrier2&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#aba3677f684e9f7bce7ab67e2c18790d0">MakeBarrierPrepareForRead</a> (VkPipelineStageFlags2 dstStageMask, VkAccessFlags2 dstAccessMask) const</td></tr>
<tr class="memdesc:aba3677f684e9f7bce7ab67e2c18790d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a barrier which prepares the device buffer for read access.  <br /></td></tr>
<tr class="separator:aba3677f684e9f7bce7ab67e2c18790d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad07ebb277b8267b2aa31ee9cc4a071da" id="r_ad07ebb277b8267b2aa31ee9cc4a071da"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#ad07ebb277b8267b2aa31ee9cc4a071da">Exists</a> () const</td></tr>
<tr class="separator:ad07ebb277b8267b2aa31ee9cc4a071da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad563e6e05511ecab34c94db7b498ebce" id="r_ad563e6e05511ecab34c94db7b498ebce"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#ad563e6e05511ecab34c94db7b498ebce">GetName</a> () const</td></tr>
<tr class="separator:ad563e6e05511ecab34c94db7b498ebce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6246bc2cf94c39999b4bf9f11e61af55" id="r_a6246bc2cf94c39999b4bf9f11e61af55"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classforay_1_1util_1_1DualBuffer.html">DualBuffer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#a6246bc2cf94c39999b4bf9f11e61af55">SetName</a> (std::string_view name)</td></tr>
<tr class="separator:a6246bc2cf94c39999b4bf9f11e61af55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89f19a0f4c82d611cac45e0029fc7dbf" id="r_a89f19a0f4c82d611cac45e0029fc7dbf"><td class="memItemLeft" align="right" valign="top">VkDescriptorBufferInfo&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#a89f19a0f4c82d611cac45e0029fc7dbf">GetVkDescriptorInfo</a> () const</td></tr>
<tr class="separator:a89f19a0f4c82d611cac45e0029fc7dbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a065a9eb1e980f402959ac3918bb532fb" id="r_a065a9eb1e980f402959ac3918bb532fb"><td class="memItemLeft" align="right" valign="top">VkBuffer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#a065a9eb1e980f402959ac3918bb532fb">GetDeviceVkBuffer</a> () const</td></tr>
<tr class="separator:a065a9eb1e980f402959ac3918bb532fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c4c48c4771674d5d06e1490ab6fd3d8" id="r_a9c4c48c4771674d5d06e1490ab6fd3d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#a9c4c48c4771674d5d06e1490ab6fd3d8">Destroy</a> ()</td></tr>
<tr class="separator:a9c4c48c4771674d5d06e1490ab6fd3d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace4dfe6db7d99948f4d77c2f6a96f60b" id="r_ace4dfe6db7d99948f4d77c2f6a96f60b"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#ace4dfe6db7d99948f4d77c2f6a96f60b">~DualBuffer</a> ()</td></tr>
<tr class="separator:ace4dfe6db7d99948f4d77c2f6a96f60b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classforay_1_1NoMoveDefaults"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classforay_1_1NoMoveDefaults')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classforay_1_1NoMoveDefaults.html">foray::NoMoveDefaults</a></td></tr>
<tr class="memitem:a8b23542ec51c029902b3792520961621 inherit pub_methods_classforay_1_1NoMoveDefaults" id="r_a8b23542ec51c029902b3792520961621"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1NoMoveDefaults.html#a8b23542ec51c029902b3792520961621">NoMoveDefaults</a> ()=default</td></tr>
<tr class="separator:a8b23542ec51c029902b3792520961621 inherit pub_methods_classforay_1_1NoMoveDefaults"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77d26d4bef77a5b1ca2efb50494e5fe0 inherit pub_methods_classforay_1_1NoMoveDefaults" id="r_a77d26d4bef77a5b1ca2efb50494e5fe0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1NoMoveDefaults.html#a77d26d4bef77a5b1ca2efb50494e5fe0">NoMoveDefaults</a> (const <a class="el" href="classforay_1_1NoMoveDefaults.html">NoMoveDefaults</a> &amp;other)=delete</td></tr>
<tr class="separator:a77d26d4bef77a5b1ca2efb50494e5fe0 inherit pub_methods_classforay_1_1NoMoveDefaults"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a288983bc7ab7c2da6b1cadc72e3e0203 inherit pub_methods_classforay_1_1NoMoveDefaults" id="r_a288983bc7ab7c2da6b1cadc72e3e0203"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1NoMoveDefaults.html#a288983bc7ab7c2da6b1cadc72e3e0203">NoMoveDefaults</a> (<a class="el" href="classforay_1_1NoMoveDefaults.html">NoMoveDefaults</a> &amp;&amp;other)=default</td></tr>
<tr class="separator:a288983bc7ab7c2da6b1cadc72e3e0203 inherit pub_methods_classforay_1_1NoMoveDefaults"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad463ec13f482b4a6fc3efe84f5ab5512 inherit pub_methods_classforay_1_1NoMoveDefaults" id="r_ad463ec13f482b4a6fc3efe84f5ab5512"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classforay_1_1NoMoveDefaults.html">NoMoveDefaults</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1NoMoveDefaults.html#ad463ec13f482b4a6fc3efe84f5ab5512">operator=</a> (const <a class="el" href="classforay_1_1NoMoveDefaults.html">NoMoveDefaults</a> &amp;other)=delete</td></tr>
<tr class="separator:ad463ec13f482b4a6fc3efe84f5ab5512 inherit pub_methods_classforay_1_1NoMoveDefaults"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a342e7bfca9025d5f7dd81cbdd8ad8b36" id="r_a342e7bfca9025d5f7dd81cbdd8ad8b36"><td class="memItemLeft" align="right" valign="top">std::vector&lt; void * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#a342e7bfca9025d5f7dd81cbdd8ad8b36">mStagingBufferMaps</a></td></tr>
<tr class="memdesc:a342e7bfca9025d5f7dd81cbdd8ad8b36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Memory locations the permanently mapped staging buffers are mapped to.  <br /></td></tr>
<tr class="separator:a342e7bfca9025d5f7dd81cbdd8ad8b36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a102c9e3bc0c85bd2e5c3f4146a6015bc" id="r_a102c9e3bc0c85bd2e5c3f4146a6015bc"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::unique_ptr&lt; <a class="el" href="classforay_1_1core_1_1ManagedBuffer.html">core::ManagedBuffer</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#a102c9e3bc0c85bd2e5c3f4146a6015bc">mStagingBuffers</a></td></tr>
<tr class="memdesc:a102c9e3bc0c85bd2e5c3f4146a6015bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Permanently mapped host-local staging buffers (one per frame in flight)  <br /></td></tr>
<tr class="separator:a102c9e3bc0c85bd2e5c3f4146a6015bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada12745bdb773982b49fd70f6b186ed4" id="r_ada12745bdb773982b49fd70f6b186ed4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; VkBufferCopy &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#ada12745bdb773982b49fd70f6b186ed4">mBufferCopies</a></td></tr>
<tr class="memdesc:ada12745bdb773982b49fd70f6b186ed4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Record of all buffer copies submitted. Added to when writing to staging buffers, cleared when building the commandbuffer.  <br /></td></tr>
<tr class="separator:ada12745bdb773982b49fd70f6b186ed4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a640fd504cc4559d9e95414fa8aaf49de" id="r_a640fd504cc4559d9e95414fa8aaf49de"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classforay_1_1core_1_1ManagedBuffer.html">core::ManagedBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classforay_1_1util_1_1DualBuffer.html#a640fd504cc4559d9e95414fa8aaf49de">mDeviceBuffer</a></td></tr>
<tr class="memdesc:a640fd504cc4559d9e95414fa8aaf49de"><td class="mdescLeft">&#160;</td><td class="mdescRight">The buffer used by the device.  <br /></td></tr>
<tr class="separator:a640fd504cc4559d9e95414fa8aaf49de"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Helper class for organizing CPU -&gt; GPU data synchronisation. In flight data is stored on host side, and copied to GPU right before being used. </p>
<p>Temporarily stores CPU-calculated states in staging buffers (1x per frame in flight) The GPU can retrieve the CPU-side data as needed via a copy command </p>
<h1><a class="anchor" id="autotoc_md68"></a>
Uploading Data</h1>
<ul>
<li>Stage sections or full buffer</li>
<li>Record CmdCopyToDevice </li>
</ul>
<h1><a class="anchor" id="autotoc_md69"></a>
Reading data</h1>
<ul>
<li>Record CmdPrepareForRead</li>
<li>Access the buffer as you wish </li>
</ul>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ace4dfe6db7d99948f4d77c2f6a96f60b" name="ace4dfe6db7d99948f4d77c2f6a96f60b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace4dfe6db7d99948f4d77c2f6a96f60b">&#9670;&#160;</a></span>~DualBuffer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual foray::util::DualBuffer::~DualBuffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aeea3a09a161b08038e4788fe4ba05d05" name="aeea3a09a161b08038e4788fe4ba05d05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeea3a09a161b08038e4788fe4ba05d05">&#9670;&#160;</a></span>CmdCopyToDevice()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void foray::util::DualBuffer::CmdCopyToDevice </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>frameIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VkCommandBuffer&#160;</td>
          <td class="paramname"><em>cmdBuffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Writes commands required to copy the changes recorded in the indexed staging buffer to the device buffer. </p>
<dl class="section remark"><dt>Remarks</dt><dd>This will mirror any buffer copies submitted via 'StageSection'/'StageFullBuffer' calls before </dd></dl>

</div>
</div>
<a id="a16509bc97b78457b76f6b7581b3b7bf2" name="a16509bc97b78457b76f6b7581b3b7bf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16509bc97b78457b76f6b7581b3b7bf2">&#9670;&#160;</a></span>CmdPrepareForRead()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void foray::util::DualBuffer::CmdPrepareForRead </td>
          <td>(</td>
          <td class="paramtype">VkCommandBuffer&#160;</td>
          <td class="paramname"><em>cmdBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VkPipelineStageFlags2&#160;</td>
          <td class="paramname"><em>dstStageMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VkAccessFlags2&#160;</td>
          <td class="paramname"><em>dstAccessMask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prepares the device buffer for read access with a pipeline barrier (must be called before read access happens to the buffer) </p>

</div>
</div>
<a id="ae046fc821df5c34879274a6b3affbfe9" name="ae046fc821df5c34879274a6b3affbfe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae046fc821df5c34879274a6b3affbfe9">&#9670;&#160;</a></span>Create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foray::util::DualBuffer::Create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structforay_1_1core_1_1Context.html">core::Context</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structforay_1_1core_1_1ManagedBuffer_1_1CreateInfo.html">core::ManagedBuffer::CreateInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>devicebufferCreateInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>stageBufferCount</em> = <code><a class="el" href="namespaceforay.html#a15b6b3f8d9dc6448821cf9a73ef346a6">INFLIGHT_FRAME_COUNT</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates the dualbuffer setup. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">devicebufferCreateInfo</td><td>Used to initate the drawside buffer. Same size is used for staging buffers </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9c4c48c4771674d5d06e1490ab6fd3d8" name="a9c4c48c4771674d5d06e1490ab6fd3d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c4c48c4771674d5d06e1490ab6fd3d8">&#9670;&#160;</a></span>Destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void foray::util::DualBuffer::Destroy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad07ebb277b8267b2aa31ee9cc4a071da" name="ad07ebb277b8267b2aa31ee9cc4a071da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad07ebb277b8267b2aa31ee9cc4a071da">&#9670;&#160;</a></span>Exists()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool foray::util::DualBuffer::Exists </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a065a9eb1e980f402959ac3918bb532fb" name="a065a9eb1e980f402959ac3918bb532fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a065a9eb1e980f402959ac3918bb532fb">&#9670;&#160;</a></span>GetDeviceVkBuffer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">VkBuffer foray::util::DualBuffer::GetDeviceVkBuffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad563e6e05511ecab34c94db7b498ebce" name="ad563e6e05511ecab34c94db7b498ebce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad563e6e05511ecab34c94db7b498ebce">&#9670;&#160;</a></span>GetName()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string foray::util::DualBuffer::GetName </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a89f19a0f4c82d611cac45e0029fc7dbf" name="a89f19a0f4c82d611cac45e0029fc7dbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89f19a0f4c82d611cac45e0029fc7dbf">&#9670;&#160;</a></span>GetVkDescriptorInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">VkDescriptorBufferInfo foray::util::DualBuffer::GetVkDescriptorInfo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aba3677f684e9f7bce7ab67e2c18790d0" name="aba3677f684e9f7bce7ab67e2c18790d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba3677f684e9f7bce7ab67e2c18790d0">&#9670;&#160;</a></span>MakeBarrierPrepareForRead()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual VkBufferMemoryBarrier2 foray::util::DualBuffer::MakeBarrierPrepareForRead </td>
          <td>(</td>
          <td class="paramtype">VkPipelineStageFlags2&#160;</td>
          <td class="paramname"><em>dstStageMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VkAccessFlags2&#160;</td>
          <td class="paramname"><em>dstAccessMask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a barrier which prepares the device buffer for read access. </p>

</div>
</div>
<a id="a6246bc2cf94c39999b4bf9f11e61af55" name="a6246bc2cf94c39999b4bf9f11e61af55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6246bc2cf94c39999b4bf9f11e61af55">&#9670;&#160;</a></span>SetName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classforay_1_1util_1_1DualBuffer.html">DualBuffer</a> &amp; foray::util::DualBuffer::SetName </td>
          <td>(</td>
          <td class="paramtype">std::string_view&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0efab9223216bc4e7c865157287f8e23" name="a0efab9223216bc4e7c865157287f8e23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0efab9223216bc4e7c865157287f8e23">&#9670;&#160;</a></span>StageFullBuffer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void foray::util::DualBuffer::StageFullBuffer </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>frameIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Updates the entire staging buffer. </p>

</div>
</div>
<a id="a7b25a6592c7a39b1a500428575919bdd" name="a7b25a6592c7a39b1a500428575919bdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b25a6592c7a39b1a500428575919bdd">&#9670;&#160;</a></span>StageSection()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void foray::util::DualBuffer::StageSection </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>frameIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>destOffset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Updates a section of a staging buffer. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ada12745bdb773982b49fd70f6b186ed4" name="ada12745bdb773982b49fd70f6b186ed4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada12745bdb773982b49fd70f6b186ed4">&#9670;&#160;</a></span>mBufferCopies</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;VkBufferCopy&gt; &gt; foray::util::DualBuffer::mBufferCopies</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Record of all buffer copies submitted. Added to when writing to staging buffers, cleared when building the commandbuffer. </p>

</div>
</div>
<a id="a640fd504cc4559d9e95414fa8aaf49de" name="a640fd504cc4559d9e95414fa8aaf49de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a640fd504cc4559d9e95414fa8aaf49de">&#9670;&#160;</a></span>mDeviceBuffer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classforay_1_1core_1_1ManagedBuffer.html">core::ManagedBuffer</a> foray::util::DualBuffer::mDeviceBuffer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The buffer used by the device. </p>

</div>
</div>
<a id="a342e7bfca9025d5f7dd81cbdd8ad8b36" name="a342e7bfca9025d5f7dd81cbdd8ad8b36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a342e7bfca9025d5f7dd81cbdd8ad8b36">&#9670;&#160;</a></span>mStagingBufferMaps</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;void*&gt; foray::util::DualBuffer::mStagingBufferMaps</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Memory locations the permanently mapped staging buffers are mapped to. </p>

</div>
</div>
<a id="a102c9e3bc0c85bd2e5c3f4146a6015bc" name="a102c9e3bc0c85bd2e5c3f4146a6015bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a102c9e3bc0c85bd2e5c3f4146a6015bc">&#9670;&#160;</a></span>mStagingBuffers</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::unique_ptr&lt;<a class="el" href="classforay_1_1core_1_1ManagedBuffer.html">core::ManagedBuffer</a>&gt; &gt; foray::util::DualBuffer::mStagingBuffers</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Permanently mapped host-local staging buffers (one per frame in flight) </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/util/<a class="el" href="foray__dualbuffer_8hpp_source.html">foray_dualbuffer.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
